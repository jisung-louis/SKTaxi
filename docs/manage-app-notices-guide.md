# ì•± ê³µì§€ ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ê°€ì´ë“œ

`scripts/manage-app-notices.js`ëŠ” Firestoreì˜ `appNotices` ì»¬ë ‰ì…˜ì„ ê´€ë¦¬í•˜ëŠ” CLI ë„êµ¬ì…ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨
1. [ê¸°ë³¸ ì‚¬ìš©ë²•](#ê¸°ë³¸-ì‚¬ìš©ë²•)
2. [ê³µì§€ ìƒì„± (Create)](#ê³µì§€-ìƒì„±-create)
3. [ê³µì§€ ìˆ˜ì • (Update)](#ê³µì§€-ìˆ˜ì •-update)
4. [ê³µì§€ ì‚­ì œ (Delete)](#ê³µì§€-ì‚­ì œ-delete)
5. [í•„ë“œ ì„¤ëª…](#í•„ë“œ-ì„¤ëª…)
6. [ì˜ˆì‹œ JSON íŒŒì¼](#ì˜ˆì‹œ-json-íŒŒì¼)

---

## ê¸°ë³¸ ì‚¬ìš©ë²•

í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
node scripts/manage-app-notices.js <command> [ì˜µì…˜]
```

### ëª…ë ¹ì–´ ì¢…ë¥˜
- `create`: ìƒˆ ê³µì§€ ìƒì„±
- `update`: ê¸°ì¡´ ê³µì§€ ìˆ˜ì •
- `delete`: ê³µì§€ ì‚­ì œ (ê´€ë ¨ ì‚¬ìš©ì ì•Œë¦¼ë„ í•¨ê»˜ ì‚­ì œ)

---

## ê³µì§€ ìƒì„± (Create)

### ë°©ë²• 1: JSON íŒŒì¼ë¡œ ìƒì„±

```bash
node scripts/manage-app-notices.js create --file ./notice.json
```

**ì˜ˆì‹œ `notice.json` íŒŒì¼:**
```json
{
  "title": "ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶œì‹œ ì•ˆë‚´",
  "content": "ì´ì œ ìµëª… ëŒ“ê¸€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
  "category": "update",
  "priority": "normal",
  "imageUrl": null,
  "actionUrl": null
}
```

> **ì°¸ê³ **: `publishedAt`ê³¼ `updatedAt`ì€ ìë™ìœ¼ë¡œ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

### ë°©ë²• 2: ëª…ë ¹ì¤„ ì¸ìë¡œ ìƒì„±

```bash
node scripts/manage-app-notices.js create \
  --title "ì„œë¹„ìŠ¤ ì ê²€ ì•ˆë‚´" \
  --content "1ì›” 20ì¼ ì˜¤ì „ 2ì‹œë¶€í„° 4ì‹œê¹Œì§€ ì ê²€ ì˜ˆì •ì…ë‹ˆë‹¤." \
  --category "service" \
  --priority "urgent"
```

**ìƒì„± ì„±ê³µ ì‹œ ì¶œë ¥:**
```
âœ… ì•± ê³µì§€ ìƒì„± ì™„ë£Œ: ì„œë¹„ìŠ¤ ì ê²€ ì•ˆë‚´ (ID: abc123xyz)
```

---

## ê³µì§€ ìˆ˜ì • (Update)

### ë°©ë²• 1: JSON íŒŒì¼ë¡œ ìˆ˜ì •

```bash
node scripts/manage-app-notices.js update --id <noticeId> --file ./partial.json
```

**ì˜ˆì‹œ `partial.json` íŒŒì¼ (ìˆ˜ì •í•  í•„ë“œë§Œ í¬í•¨):**
```json
{
  "title": "ìˆ˜ì •ëœ ì œëª©",
  "priority": "urgent"
}
```

### ë°©ë²• 2: ëª…ë ¹ì¤„ ì¸ìë¡œ ìˆ˜ì •

```bash
# ì œëª©ë§Œ ìˆ˜ì •
node scripts/manage-app-notices.js update --id abc123xyz --title "ìƒˆë¡œìš´ ì œëª©"

# ì—¬ëŸ¬ í•„ë“œ ìˆ˜ì •
node scripts/manage-app-notices.js update --id abc123xyz \
  --title "ìˆ˜ì •ëœ ì œëª©" \
  --content "ìˆ˜ì •ëœ ë‚´ìš©" \
  --priority "urgent"
```

**ìˆ˜ì • ì„±ê³µ ì‹œ ì¶œë ¥:**
```
âœ… ì•± ê³µì§€ ì—…ë°ì´íŠ¸ ì™„ë£Œ: abc123xyz
```

> **ì°¸ê³ **: `updatedAt`ì€ ìë™ìœ¼ë¡œ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.

---

## ê³µì§€ ì‚­ì œ (Delete)

```bash
node scripts/manage-app-notices.js delete --id <noticeId>
```

**ì‚­ì œ ì‹œ ë™ì‘:**
1. `appNotices/{noticeId}` ë¬¸ì„œ ì‚­ì œ
2. ëª¨ë“  ì‚¬ìš©ìì˜ `notifications` ì»¬ë ‰ì…˜ì—ì„œ `data.appNoticeId === noticeId`ì¸ ì•Œë¦¼ ë¬¸ì„œë„ í•¨ê»˜ ì‚­ì œ

**ì‚­ì œ ì„±ê³µ ì‹œ ì¶œë ¥:**
```
ğŸ—‘ï¸  ì•± ê³µì§€ ì‚­ì œ ì™„ë£Œ: abc123xyz
ğŸ” ì‚¬ìš©ì ì•Œë¦¼ ì‚­ì œ ì¤‘... (data.appNoticeId == noticeId)
ğŸ§¹ ì‚­ì œ ëŒ€ìƒ ì•Œë¦¼ ë¬¸ì„œ ìˆ˜: 150
  - ë°°ì¹˜ ì‚­ì œ ì™„ë£Œ (150/150)
âœ… ê´€ë ¨ ì‚¬ìš©ì ì•Œë¦¼ ì‚­ì œ ì™„ë£Œ
```

---

## í•„ë“œ ì„¤ëª…

| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|------|------|--------|
| `title` | string | âœ… | ê³µì§€ ì œëª© | "ì œëª© ì—†ìŒ" |
| `content` | string | âœ… | ê³µì§€ ë‚´ìš© | "" |
| `category` | string | âŒ | ê³µì§€ ì¹´í…Œê³ ë¦¬ | "info" |
| `priority` | string | âŒ | ìš°ì„ ìˆœìœ„ | "normal" |
| `publishedAt` | Timestamp | âŒ | ë°œí–‰ ì‹œê°„ | í˜„ì¬ ì‹œê°„ |
| `updatedAt` | Timestamp | âŒ | ìˆ˜ì • ì‹œê°„ | í˜„ì¬ ì‹œê°„ |
| `imageUrl` | string \| null | âŒ | ì´ë¯¸ì§€ URL | null |
| `actionUrl` | string \| null | âŒ | ì•¡ì…˜ URL (ë§í¬) | null |

### ì¹´í…Œê³ ë¦¬ (category)
- `"update"`: ì•± ì—…ë°ì´íŠ¸
- `"service"`: ì„œë¹„ìŠ¤ ê³µì§€
- `"event"`: ì´ë²¤íŠ¸
- `"policy"`: ì •ì±… ë³€ê²½
- `"info"`: ì¼ë°˜ ì •ë³´ (ê¸°ë³¸ê°’)

### ìš°ì„ ìˆœìœ„ (priority)
- `"urgent"`: ê¸´ê¸‰ (ë¹¨ê°„ìƒ‰ í‘œì‹œ)
- `"normal"`: ì¼ë°˜ (íŒŒë€ìƒ‰ í‘œì‹œ)
- `"info"`: ì •ë³´ (íšŒìƒ‰ í‘œì‹œ)

---

## ì˜ˆì‹œ JSON íŒŒì¼

### ì˜ˆì‹œ 1: ê¸°ë³¸ ê³µì§€
```json
{
  "title": "ìƒˆë¡œìš´ ìµëª… ëŒ“ê¸€ ê¸°ëŠ¥ ì¶œì‹œ!",
  "content": "ì´ì œ ê²Œì‹œíŒê³¼ ê³µì§€ì‚¬í•­ì—ì„œ ìµëª…ìœ¼ë¡œ ëŒ“ê¸€ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
  "category": "update",
  "priority": "normal",
  "imageUrl": null,
  "actionUrl": null
}
```

### ì˜ˆì‹œ 2: ê¸´ê¸‰ ì„œë¹„ìŠ¤ ì ê²€ ê³µì§€
```json
{
  "title": "ì„œë¹„ìŠ¤ ì ê²€ ì•ˆë‚´ (1ì›” 20ì¼)",
  "content": "ë” ë‚˜ì€ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ 2024ë…„ 1ì›” 20ì¼ ì˜¤ì „ 2ì‹œë¶€í„° ì˜¤ì „ 4ì‹œê¹Œì§€ ì„œë¹„ìŠ¤ ì ê²€ì„ ì‹¤ì‹œí•©ë‹ˆë‹¤.",
  "category": "service",
  "priority": "urgent",
  "imageUrl": null,
  "actionUrl": null
}
```

### ì˜ˆì‹œ 3: ì´ë²¤íŠ¸ ê³µì§€ (ì´ë¯¸ì§€ í¬í•¨)
```json
{
  "title": "ì‹ í•™ê¸° ì´ë²¤íŠ¸ - íƒì‹œë¹„ í• ì¸ ì¿ í°",
  "content": "ì‹ í•™ê¸°ë¥¼ ë§ì•„ íƒì‹œë¹„ í• ì¸ ì¿ í°ì„ ì œê³µí•©ë‹ˆë‹¤! 2ì›” í•œ ë‹¬ê°„ íƒì‹œë¹„ 20% í• ì¸ ì¿ í°ì„ ë°›ì•„ë³´ì„¸ìš”.",
  "category": "event",
  "priority": "info",
  "imageUrl": "https://example.com/event-banner.jpg",
  "actionUrl": "https://example.com/event-details"
}
```

### ì˜ˆì‹œ 4: ë¶€ë¶„ ì—…ë°ì´íŠ¸ìš© JSON (update ëª…ë ¹ì–´ ì‚¬ìš© ì‹œ)
```json
{
  "title": "ìˆ˜ì •ëœ ì œëª©",
  "priority": "urgent"
}
```

---

## ì£¼ì˜ì‚¬í•­

1. **ì„œë¹„ìŠ¤ ê³„ì • í‚¤ í•„ìš”**: `functions/serviceAccountKey.json` íŒŒì¼ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
2. **ê³µì§€ ID í™•ì¸**: `update` ë˜ëŠ” `delete` ëª…ë ¹ì–´ ì‚¬ìš© ì‹œ ê³µì§€ IDê°€ í•„ìš”í•©ë‹ˆë‹¤. Firestore ì½˜ì†”ì—ì„œ í™•ì¸í•˜ê±°ë‚˜, `create` ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ ì¶œë ¥ë˜ëŠ” IDë¥¼ ì €ì¥í•´ë‘ì„¸ìš”.
3. **ì‚­ì œ ì‹œ ì£¼ì˜**: `delete` ëª…ë ¹ì–´ëŠ” ê³µì§€ë¿ë§Œ ì•„ë‹ˆë¼ ê´€ë ¨ëœ ëª¨ë“  ì‚¬ìš©ì ì•Œë¦¼ë„ ì‚­ì œí•©ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•˜ì„¸ìš”.
4. **íƒ€ì„ìŠ¤íƒ¬í”„**: JSON íŒŒì¼ì—ì„œ `publishedAt`ì„ ì§€ì •í•˜ë ¤ë©´ ISO 8601 í˜•ì‹ ë¬¸ìì—´ì„ ì‚¬ìš©í•˜ì„¸ìš” (ì˜ˆ: `"2024-01-20T02:00:00Z"`).

---

## ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ

### 1. ìƒˆ ê³µì§€ ìƒì„±
```bash
# JSON íŒŒì¼ ìƒì„±
cat > notice.json << EOF
{
  "title": "ì•± ì—…ë°ì´íŠ¸ ì•ˆë‚´",
  "content": "ë²„ì „ 1.0.0ì´ ì¶œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "category": "update",
  "priority": "normal"
}
EOF

# ê³µì§€ ìƒì„±
node scripts/manage-app-notices.js create --file ./notice.json
```

### 2. ê³µì§€ ìˆ˜ì •
```bash
# ì œëª©ê³¼ ìš°ì„ ìˆœìœ„ë§Œ ë³€ê²½
node scripts/manage-app-notices.js update --id abc123xyz \
  --title "ê¸´ê¸‰ ì—…ë°ì´íŠ¸ ì•ˆë‚´" \
  --priority "urgent"
```

### 3. ê³µì§€ ì‚­ì œ
```bash
node scripts/manage-app-notices.js delete --id abc123xyz
```

---

## ë¬¸ì œ í•´ê²°

### ì˜¤ë¥˜: `serviceAccountKey.jsonì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`
- `functions/serviceAccountKey.json` íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
- Firebase ì½˜ì†”ì—ì„œ ì„œë¹„ìŠ¤ ê³„ì • í‚¤ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ í•´ë‹¹ ê²½ë¡œì— ë°°ì¹˜í•˜ì„¸ìš”.

### ì˜¤ë¥˜: `updateì—ëŠ” --id ê°€ í•„ìš”í•©ë‹ˆë‹¤`
- `update` ë˜ëŠ” `delete` ëª…ë ¹ì–´ ì‚¬ìš© ì‹œ `--id` ì˜µì…˜ì„ ë°˜ë“œì‹œ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.

### ì˜¤ë¥˜: `ì—…ë°ì´íŠ¸í•  í•„ë“œê°€ ì—†ìŠµë‹ˆë‹¤`
- `update` ëª…ë ¹ì–´ì—ì„œ ìˆ˜ì •í•  í•„ë“œë¥¼ í•˜ë‚˜ ì´ìƒ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.


